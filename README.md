# IntuneSettingsToOmaUri

## Overview

`IntuneSettingsToOmaUri` is a PowerShell module designed to simplify the process of mapping Intune "Settings Catalog" profiles to their corresponding OMA-URI values. This tool is particularly useful for comparing policies and understanding the underlying OMA-URI configurations of Intune profiles.

It is very "proof of concept" currently and has had limited testing. But uploading in case someone else finds it useful.

It is primarily designed to run against exports generated by [IntuneManagement](https://github.com/Micke-K/IntuneManagement/)

You need to also mirror the policy definitions from [https://github.com/pl4nty/intune-change-tracking](https://github.com/pl4nty/intune-change-tracking)


## Usage

```powershell
Import-Module .\IntuneSettingsToOmaUri.psm1

# Convert export from IntuneManagement
Convert-IntuneSettingsToOmaUri -Path '.\exports\ASD Windows Hardening Guidelines.json' -OutputPath '.\output\ASD_Windows_Hardening_Guidelines.json'

# Save copy from graph directly
# Ensure you are connected with Connect-MgGraph

# Provide ID from Get-MgDeviceManagementDeviceConfiguration

Export-SettingsCatalogAsOmiUri -SettingsCatalogId "028a4f25-6383-4067-9485-1bf63535aa1c" #-OutputPath '.\output\ASD_Edge_Hardening_Guidelines.json'


```